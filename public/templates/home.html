<div class="panel-group" id="accordion" ng-controller="HomeController">
  <div class="panel panel-default" ng-repeat="ticket in tickets">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a data-toggle="collapse" data-parent="#accordion" data-target="#collapse{{ticket.id}}" href="">
          {{ticket.wager_type}} on {{ticket.wager_date | date:'MMM dd, yyyy'}}
        </a>
      </h4>
    </div>
    <div id="collapse{{ticket.id}}" class="panel-collapse collapse">
      <div class="panel-body">
        <h4 class="pull-left">{{ticket.amount_wagered | currency}}</h4>
        <button class="pull-right btn btn-danger" ng-click="toggleShowEditPanel()">Edit</button>
        <div class="clearfix"></div>
        <p class="small">
          <span >Tags: </span>
          <span class="small" ng-repeat="ticketTag in ticket.ticket_tags">({{ticketTag.name}} {{ticketTag.amount | currency}}) </span>
        </p>
        <div style="margin-bottom: 5px;" ng-show="showEditPanel">
          <button ng-repeat="ticketTag in ticket.ticket_tags"
                  class="btn btn-danger"
                  ng-click="deleteTag(ticketTag, ticket)"
                  style="margin: 0 5px 5px 0;">
            {{ticketTag.name}} {{ticketTag.amount | currency}}
          </button>
        </div>
        <div>
          <span ng-repeat="tag in tags" style="margin-right: 5px;">
            <button class="btn btn-primary"
                    ng-click="selectTag(ticket, tag)"
                    ng-class="isSelectedTag(ticket, tag) ? 'btn-danger' : '' ">
              {{tag.name}}
            </button>
          </span>
        </div>
        <div id="collapse-tag-amount-{{ticket.id}}" class="tag-amount-panel" ng-show="isSelectedTicket(ticket)">
          <button class="btn btn-success" ng-click="createTicketTag(ticket, 5.0)">$5</button>
          <button class="btn btn-success" ng-click="createTicketTag(ticket, 10.0)">$10</button>
          <button class="btn btn-success" ng-click="createTicketTag(ticket, 15.0)">$15</button>
          <button class="btn btn-success" ng-click="createTicketTag(ticket, 20.0)">$20</button>
          <button class="btn btn-success" ng-click="selectCustomTagAmount(ticket, 0)">Custom</button>
        </div>
        <div ng-show="customAmountSelected(ticket)" class="custom-tag-amount-container">
          <form role="form" class="form-inline">
            <input class="form-control" id="tag-amount" type="text" pattern="\d*">
            <button class="btn btn-success" ng-click="submitCustomTag(ticket, $event)">Submit</button>
          </form>
        </div>
        <table class="table-condensed" ng-repeat="ticketLineItem in ticket.ticket_line_items">
          <tr>
            <th colspan="2">{{ticketLineItem.line_item_date | date:'M/d/yy'}}: {{ticketLineItem.line_item_spread}}</th>
          </tr>
          <tr>
            <td>{{ticketLineItem.away_team}}<br />{{ticketLineItem.home_team}}</td>
            <td>{{ticketLineItem.away_score}}<br />{{ticketLineItem.home_score}}</td>
          </tr>
        </table>
      </div>
    </div>
  </div>

</div>